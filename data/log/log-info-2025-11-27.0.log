25-11-27.16:28:35.267 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.16:28:35.280 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 43385 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.16:28:35.281 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.16:28:35.748 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.16:28:35.750 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.16:28:35.770 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
25-11-27.16:28:36.148 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus
25-11-27.16:28:36.148 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.16:28:36.149 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.16:28:36.155 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.16:28:36.156 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.16:28:36.156 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.16:28:36.156 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.16:28:36.157 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.16:28:36.157 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.16:28:36.157 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.16:28:36.157 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.16:28:36.290 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.16:28:36.405 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.16:28:36.411 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.16:28:36.534 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@5f65e0c0
25-11-27.16:28:36.535 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.16:28:36.568 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.16:28:36.568 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.16:28:36.568 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.16:28:36.568 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.16:28:36.570 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.16:28:36.573 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.16:28:36.573 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.16:28:39.732 [main            ] ERROR SemanticIntentDetector - 批量生成向量失败，降级为逐个生成
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1858)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1789)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1586)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.lambda$getConnection$0(LettuceConnectionFactory.java:1566)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.doInLock(LettuceConnectionFactory.java:1527)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1563)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1249)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:1055)
	at org.springframework.data.redis.cache.DefaultRedisCacheWriter.execute(DefaultRedisCacheWriter.java:401)
	at org.springframework.data.redis.cache.DefaultRedisCacheWriter.get(DefaultRedisCacheWriter.java:142)
	at org.springframework.data.redis.cache.DefaultRedisCacheWriter.get(DefaultRedisCacheWriter.java:133)
	at org.springframework.data.redis.cache.RedisCache.lookup(RedisCache.java:185)
	at org.springframework.cache.support.AbstractValueAdaptingCache.get(AbstractValueAdaptingCache.java:65)
	at org.springframework.cache.transaction.TransactionAwareCacheDecorator.get(TransactionAwareCacheDecorator.java:88)
	at cn.cug.sxy.ai.infrastructure.embedding.SpringAIEmbeddingService.generateEmbeddings(SpringAIEmbeddingService.java:92)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:723)
	at cn.cug.sxy.ai.infrastructure.embedding.SpringAIEmbeddingService$$SpringCGLIB$$1.generateEmbeddings(<generated>)
	at cn.cug.sxy.ai.domain.rag.service.intent.detector.SemanticIntentDetector.refreshRoutes(SemanticIntentDetector.java:90)
	at cn.cug.sxy.ai.domain.rag.service.intent.detector.SemanticIntentDetector.init(SemanticIntentDetector.java:49)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMethod.invoke(InitDestroyAnnotationBeanPostProcessor.java:457)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:401)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:219)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:423)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1804)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:346)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1916)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1880)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeanCollection(DefaultListableBeanFactory.java:1770)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1738)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1613)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1552)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:913)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:240)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1381)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1218)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:346)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1606)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1552)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:913)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:240)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1381)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1218)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:346)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1155)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1121)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1056)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.test.context.SpringBootContextLoader.lambda$loadContext$3(SpringBootContextLoader.java:137)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:58)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:46)
	at org.springframework.boot.SpringApplication.withHook(SpringApplication.java:1461)
	at org.springframework.boot.test.context.SpringBootContextLoader$ContextLoaderHook.run(SpringBootContextLoader.java:553)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:137)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:108)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:225)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:152)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:130)
	at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:200)
	at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:139)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:260)
	at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:160)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:378)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:383)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$12(ClassBasedTestDescriptor.java:378)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:377)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$7(ClassBasedTestDescriptor.java:290)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:289)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:279)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$6(ClassBasedTestDescriptor.java:278)
	at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$1(TestMethodTestDescriptor.java:105)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:104)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:128)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:128)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: org.springframework.data.redis.connection.PoolException: Could not prepare the pool
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.lambda$getConnection$1(LettucePoolingConnectionProvider.java:101)
	at java.base/java.util.concurrent.ConcurrentHashMap.computeIfAbsent(ConcurrentHashMap.java:1708)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.getConnection(LettucePoolingConnectionProvider.java:93)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1787)
	... 159 common frames omitted
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 192.168.2.219/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:63)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:41)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:354)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:219)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:112)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:112)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.lambda$getConnection$0(LettucePoolingConnectionProvider.java:96)
	at io.lettuce.core.support.ConnectionPoolSupport$RedisPooledObjectFactory.create(ConnectionPoolSupport.java:196)
	at io.lettuce.core.support.ConnectionPoolSupport$RedisPooledObjectFactory.create(ConnectionPoolSupport.java:186)
	at org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:68)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:557)
	at org.apache.commons.pool2.impl.GenericObjectPool.ensureIdle(GenericObjectPool.java:630)
	at org.apache.commons.pool2.impl.GenericObjectPool.ensureMinIdle(GenericObjectPool.java:652)
	at org.apache.commons.pool2.impl.GenericObjectPool.preparePool(GenericObjectPool.java:970)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.lambda$getConnection$1(LettucePoolingConnectionProvider.java:99)
	... 162 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at io.netty.channel.nio.AbstractNioChannel.doClose(AbstractNioChannel.java:507)
	at io.netty.channel.socket.nio.NioSocketChannel.doClose(NioSocketChannel.java:348)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.doClose0(AbstractChannel.java:752)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:729)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:619)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.close(DefaultChannelPipeline.java:1299)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:755)
	at io.netty.channel.AbstractChannelHandlerContext.access$1200(AbstractChannelHandlerContext.java:61)
	at io.netty.channel.AbstractChannelHandlerContext$11.run(AbstractChannelHandlerContext.java:738)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)
25-11-27.16:28:39.737 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 7
25-11-27.16:28:40.267 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 4
25-11-27.16:28:40.631 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 5
25-11-27.16:28:40.792 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 4
25-11-27.16:28:40.934 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 5
25-11-27.16:28:41.156 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 4
25-11-27.16:28:41.299 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 7
25-11-27.16:28:41.445 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 4
25-11-27.16:28:41.676 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 6
25-11-27.16:28:41.835 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 6
25-11-27.16:28:41.982 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 7
25-11-27.16:28:42.201 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 7
25-11-27.16:28:42.346 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 4
25-11-27.16:28:42.514 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 6
25-11-27.16:28:42.725 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 4
25-11-27.16:28:42.866 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 4
25-11-27.16:28:43.004 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 6
25-11-27.16:28:43.250 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 7
25-11-27.16:28:43.378 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.16:28:43.382 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.16:28:43.397 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.16:28:43.397 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.16:28:43.404 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.16:28:43.426 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.16:28:43.427 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.16:28:43.564 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:28:43.770 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.16:28:43.900 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:28:44.032 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.16:28:44.298 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:28:44.433 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:28:44.593 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:28:44.822 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:28:44.957 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:28:45.113 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:28:45.347 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.16:28:45.496 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.16:28:45.637 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:28:45.871 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:28:46.037 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:28:46.173 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:28:46.396 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:28:46.538 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:28:46.670 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:28:46.931 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:28:47.065 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:28:47.195 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:28:47.442 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:28:47.602 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:28:47.742 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.16:28:47.966 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:28:48.111 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:28:48.244 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:28:48.490 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:28:48.615 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:28:48.765 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:28:49.017 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:28:49.166 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:28:49.379 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:28:49.542 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:28:49.685 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:28:49.816 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:28:50.062 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.16:28:50.284 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:28:50.415 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:28:50.592 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:28:50.736 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:28:50.884 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.16:28:50.930 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.16:28:50.930 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.16:28:54.028 [main            ] ERROR CacheCleanupService    - 清理embeddings缓存失败
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1858)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1789)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1586)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.lambda$getConnection$0(LettuceConnectionFactory.java:1566)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.doInLock(LettuceConnectionFactory.java:1527)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1563)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1249)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:1055)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:195)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:398)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:378)
	at org.springframework.data.redis.core.RedisTemplate.doWithKeys(RedisTemplate.java:790)
	at org.springframework.data.redis.core.RedisTemplate.keys(RedisTemplate.java:643)
	at cn.cug.sxy.ai.infrastructure.cache.CacheCleanupService.cleanupEmbeddingsCache(CacheCleanupService.java:47)
	at cn.cug.sxy.ai.infrastructure.cache.CacheCleanupService.init(CacheCleanupService.java:90)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMethod.invoke(InitDestroyAnnotationBeanPostProcessor.java:457)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:401)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:219)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:423)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1804)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:346)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1155)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1121)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1056)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.test.context.SpringBootContextLoader.lambda$loadContext$3(SpringBootContextLoader.java:137)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:58)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:46)
	at org.springframework.boot.SpringApplication.withHook(SpringApplication.java:1461)
	at org.springframework.boot.test.context.SpringBootContextLoader$ContextLoaderHook.run(SpringBootContextLoader.java:553)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:137)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:108)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:225)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:152)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:130)
	at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:200)
	at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:139)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:260)
	at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:160)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:378)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:383)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$12(ClassBasedTestDescriptor.java:378)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:377)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$7(ClassBasedTestDescriptor.java:290)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:289)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:279)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$6(ClassBasedTestDescriptor.java:278)
	at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$1(TestMethodTestDescriptor.java:105)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:104)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:128)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:128)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: org.springframework.data.redis.connection.PoolException: Could not prepare the pool
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.lambda$getConnection$1(LettucePoolingConnectionProvider.java:101)
	at java.base/java.util.concurrent.ConcurrentHashMap.computeIfAbsent(ConcurrentHashMap.java:1708)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.getConnection(LettucePoolingConnectionProvider.java:93)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1787)
	... 121 common frames omitted
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to 192.168.2.219/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:63)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:41)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:354)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:219)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:112)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:112)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.lambda$getConnection$0(LettucePoolingConnectionProvider.java:96)
	at io.lettuce.core.support.ConnectionPoolSupport$RedisPooledObjectFactory.create(ConnectionPoolSupport.java:196)
	at io.lettuce.core.support.ConnectionPoolSupport$RedisPooledObjectFactory.create(ConnectionPoolSupport.java:186)
	at org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:68)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:557)
	at org.apache.commons.pool2.impl.GenericObjectPool.ensureIdle(GenericObjectPool.java:630)
	at org.apache.commons.pool2.impl.GenericObjectPool.ensureMinIdle(GenericObjectPool.java:652)
	at org.apache.commons.pool2.impl.GenericObjectPool.preparePool(GenericObjectPool.java:970)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.lambda$getConnection$1(LettucePoolingConnectionProvider.java:99)
	... 124 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at io.netty.channel.nio.AbstractNioChannel.doClose(AbstractNioChannel.java:507)
	at io.netty.channel.socket.nio.NioSocketChannel.doClose(NioSocketChannel.java:348)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.doClose0(AbstractChannel.java:752)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:729)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:619)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.close(DefaultChannelPipeline.java:1299)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:755)
	at io.netty.channel.AbstractChannelHandlerContext.access$1200(AbstractChannelHandlerContext.java:61)
	at io.netty.channel.AbstractChannelHandlerContext$11.run(AbstractChannelHandlerContext.java:738)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)
25-11-27.16:28:54.113 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.16:28:54.269 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 19.157 seconds (process running for 19.611)
25-11-27.16:28:54.270 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.16:28:54.271 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.16:28:54.350 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@6def1699
25-11-27.16:28:54.350 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.16:28:54.359 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.16:28:54.359 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:28:54.360 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.360 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.360 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.360 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.360 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.521 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:28:54.526 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:28:54.526 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:28:54.526 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.526 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.526 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.526 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.526 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:28:54.778 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:28:54.778 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:28:54.780 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.16:28:54.780 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.16:28:54.780 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:28:55.530 [pool-5-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.16:28:55.530 [pool-5-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.16:28:55.547 [pool-5-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.16:28:55.554 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.16:28:55.556 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.16:28:56.009 [HttpClient-1-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.16:28:56.112 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.16:28:56.113 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.16:28:56.688 [pool-11-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.16:28:56.689 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.16:28:56.689 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.16:28:57.743 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.16:28:57.925 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.16:28:57.926 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.16:28:57.926 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:28:57.963 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.16:28:58.552 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.16:28:58.553 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:28:58.555 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.16:28:58.556 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.16:28:58.557 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.16:28:58.557 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.16:28:58.557 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.16:28:58.811 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.16:28:58.814 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.16:28:58.814 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.16:28:58.814 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.16:30:31.983 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.16:30:31.996 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 43653 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.16:30:31.996 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.16:30:32.448 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.16:30:32.449 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.16:30:32.467 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
25-11-27.16:30:32.911 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus
25-11-27.16:30:32.912 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.16:30:32.914 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.16:30:32.922 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.16:30:32.925 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.16:30:32.925 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.16:30:32.925 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.16:30:32.925 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.16:30:32.925 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.16:30:32.925 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.16:30:32.925 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.16:30:33.147 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.16:30:33.313 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.16:30:33.319 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.16:30:33.448 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@566cc6af
25-11-27.16:30:33.451 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.16:30:33.471 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.16:30:33.471 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.16:30:33.471 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.16:30:33.471 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.16:30:33.473 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.16:30:33.479 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.16:30:33.479 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.16:30:33.920 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.16:30:33.922 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.16:30:33.932 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.16:30:33.932 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.16:30:33.939 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.16:30:33.959 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.16:30:33.959 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.16:30:34.438 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:30:34.610 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.16:30:34.775 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:30:35.086 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.16:30:35.280 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:30:35.450 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:30:35.642 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:30:35.800 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:30:35.975 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:30:36.123 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:30:36.284 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.16:30:36.497 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.16:30:36.654 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:30:36.805 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:30:37.021 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:30:37.160 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:30:37.341 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:30:37.546 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:30:37.708 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:30:37.843 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:30:38.069 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:30:38.223 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:30:38.370 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:30:38.591 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:30:38.724 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.16:30:38.890 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:30:39.115 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:30:39.253 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:30:39.642 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:30:39.790 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:30:39.941 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:30:40.164 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:30:40.425 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:30:40.692 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:30:40.854 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:30:41.016 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:30:41.216 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:30:41.360 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.16:30:41.521 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:30:41.737 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:30:41.908 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:30:42.065 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:30:42.266 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.16:30:42.310 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.16:30:42.310 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.16:30:42.316 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.16:30:42.367 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.16:30:42.506 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 10.688 seconds (process running for 11.157)
25-11-27.16:30:42.507 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.16:30:42.508 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.16:30:42.587 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@1c74251b
25-11-27.16:30:42.587 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.16:30:42.600 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.16:30:42.600 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:30:42.600 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.601 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.601 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.601 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.601 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.906 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:30:42.911 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:30:42.911 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:30:42.911 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.911 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.911 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.911 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.911 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:30:42.981 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:30:42.981 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:30:42.982 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.16:30:42.982 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.16:30:42.982 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:30:43.447 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.16:30:43.447 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.16:30:43.462 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.16:30:43.464 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.16:30:43.465 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.16:30:43.839 [HttpClient-1-Worker-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.16:30:43.938 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.16:30:43.939 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.16:30:44.348 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.16:30:44.348 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.16:30:44.348 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.16:30:44.888 [HttpClient-2-Worker-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.16:30:45.124 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.16:30:45.124 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.16:30:45.125 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:30:45.159 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.16:30:45.593 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.16:30:45.594 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:30:45.596 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.16:30:45.597 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.16:30:45.597 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.16:30:45.597 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.16:30:45.597 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.16:30:45.833 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 简单模式
25-11-27.16:30:45.923 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:30:45.941 [main            ] INFO  HybridDocumentParser   - 简单模式解析完成，文件: src/test/resources/pdfs/test_pdf_1.pdf, 文本长度: 792
25-11-27.16:30:45.969 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.16:30:45.971 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.16:30:45.972 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.16:30:45.972 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.16:31:47.580 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.16:31:47.595 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 43796 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.16:31:47.595 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.16:31:48.019 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.16:31:48.021 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.16:31:48.037 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
25-11-27.16:31:48.470 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus
25-11-27.16:31:48.471 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.16:31:48.472 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.16:31:48.479 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.16:31:48.481 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.16:31:48.481 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.16:31:48.481 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.16:31:48.481 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.16:31:48.481 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.16:31:48.481 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.16:31:48.481 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.16:31:48.619 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.16:31:48.752 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.16:31:48.766 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.16:31:48.938 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@1614499b
25-11-27.16:31:48.938 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.16:31:48.962 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.16:31:48.962 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.16:31:48.962 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.16:31:48.962 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.16:31:48.964 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.16:31:48.967 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.16:31:48.967 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.16:31:49.387 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.16:31:49.389 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.16:31:49.398 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.16:31:49.398 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.16:31:49.405 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.16:31:49.425 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.16:31:49.426 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.16:31:49.940 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:31:50.426 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.16:31:50.569 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:31:50.740 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.16:31:50.950 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:31:51.090 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:31:51.248 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:31:51.472 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:31:51.636 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:31:51.804 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:31:51.997 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.16:31:52.137 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.16:31:52.283 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:31:52.521 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:31:52.657 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:31:52.806 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:31:53.044 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:31:53.204 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:31:53.371 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:31:53.569 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:31:53.736 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:31:53.905 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:31:54.160 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:31:54.633 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:31:54.769 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.16:31:54.920 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:31:55.140 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:31:55.294 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:31:55.444 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:31:55.665 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:31:55.794 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:31:56.025 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:31:56.191 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:31:56.344 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:31:56.462 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:31:56.712 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:31:56.836 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:31:56.961 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.16:31:57.238 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:31:57.375 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:31:57.512 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:31:57.762 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:31:57.906 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.16:31:57.948 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.16:31:57.948 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.16:31:57.955 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.16:31:58.015 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.16:31:58.152 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 10.725 seconds (process running for 11.213)
25-11-27.16:31:58.153 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.16:31:58.154 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.16:31:58.329 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@d41518b
25-11-27.16:31:58.329 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.16:31:58.339 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.16:31:58.340 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:31:58.340 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.340 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.340 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.340 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.340 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.494 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:31:58.498 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:31:58.498 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:31:58.498 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.498 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.498 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.498 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.498 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:31:58.572 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:31:58.572 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:31:58.573 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.16:31:58.574 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.16:31:58.574 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:31:58.938 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.16:31:58.939 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.16:31:58.954 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.16:31:58.957 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.16:31:58.958 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.16:31:59.339 [HttpClient-1-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.16:31:59.437 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.16:31:59.438 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.16:31:59.836 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.16:31:59.837 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.16:31:59.837 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.16:32:00.910 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.16:32:01.133 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.16:32:01.133 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.16:32:01.134 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:32:01.168 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.16:32:02.204 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.16:32:02.205 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:32:02.207 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.16:32:02.207 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.16:32:02.208 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.16:32:02.208 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.16:32:02.208 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.16:32:02.439 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 复杂模式
25-11-27.16:32:02.439 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.16:32:03.119 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:32:03.481 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.16:33:01.228 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.16:33:09.166 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.16:33:09.186 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:33:09.212 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=2, 元素数=5, 表格数=1, 平均置信度={:.2f}, 压缩比={:.2f}x, 处理时间=0.9620000000000001ms
25-11-27.16:33:09.212 [main            ] INFO  HybridDocumentParser   - 复杂模式解析完成，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.16:33:09.231 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.16:33:09.231 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.16:33:09.232 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.16:33:09.232 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.16:35:49.355 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.16:35:49.367 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 44195 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.16:35:49.367 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.16:35:49.758 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.16:35:49.759 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.16:35:49.775 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
25-11-27.16:35:50.175 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus
25-11-27.16:35:50.176 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.16:35:50.176 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.16:35:50.181 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.16:35:50.183 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.16:35:50.183 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.16:35:50.183 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.16:35:50.183 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.16:35:50.183 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.16:35:50.183 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.16:35:50.183 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.16:35:50.320 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.16:35:50.442 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.16:35:50.449 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.16:35:50.648 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@3aa1c45
25-11-27.16:35:50.650 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.16:35:50.678 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.16:35:50.678 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.16:35:50.678 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.16:35:50.678 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.16:35:50.680 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.16:35:50.685 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.16:35:50.685 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.16:35:51.145 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.16:35:51.147 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.16:35:51.155 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.16:35:51.156 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.16:35:51.162 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.16:35:51.183 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.16:35:51.184 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.16:35:51.663 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:35:51.807 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.16:35:51.961 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:35:52.123 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.16:35:52.279 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:35:52.445 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:35:52.794 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:35:52.942 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:35:53.173 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:35:53.326 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:35:53.529 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.16:35:53.694 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.16:35:53.859 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:35:54.014 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:35:54.218 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:35:54.366 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:35:54.543 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:35:54.742 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:35:54.910 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:35:55.065 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:35:55.268 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:35:55.400 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:35:55.546 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:35:55.794 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:35:56.007 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.16:35:56.149 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:35:56.318 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:35:56.452 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:35:56.616 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:35:56.840 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:35:56.963 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:35:57.104 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:35:57.366 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:35:57.511 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:35:57.654 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:35:57.889 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:35:58.041 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:35:58.178 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.16:35:58.414 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:35:58.559 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:35:58.937 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:35:59.073 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:35:59.213 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.16:35:59.254 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.16:35:59.255 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.16:35:59.260 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.16:35:59.315 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.16:35:59.466 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 10.251 seconds (process running for 10.714)
25-11-27.16:35:59.466 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.16:35:59.468 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.16:35:59.553 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@41dbf02b
25-11-27.16:35:59.553 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.16:35:59.562 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.16:35:59.562 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:35:59.563 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.563 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.563 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.563 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.563 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.724 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:35:59.729 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:35:59.729 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:35:59.729 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.730 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.730 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.730 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.730 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:35:59.800 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:35:59.801 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:35:59.801 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.16:35:59.802 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.16:35:59.802 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:36:00.277 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.16:36:00.277 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.16:36:00.293 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.16:36:00.295 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.16:36:00.296 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.16:36:00.823 [HttpClient-1-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.16:36:01.029 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.16:36:01.030 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.16:36:01.530 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.16:36:01.530 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.16:36:01.530 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.16:36:01.852 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.16:36:02.081 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.16:36:02.081 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.16:36:02.082 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:36:02.109 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.16:36:02.633 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.16:36:02.633 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:36:02.635 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.16:36:02.636 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.16:36:02.636 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.16:36:02.636 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.16:36:02.636 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.16:36:02.872 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 自动模式
25-11-27.16:36:02.957 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:36:02.977 [main            ] INFO  PdfTableDetector       - 表格检测完成: 文件=src/test/resources/pdfs/test_pdf_1.pdf, 页数=2, 检测到表格=true, 表格分数={:.2f}, 建议=0.704
25-11-27.16:36:02.977 [main            ] INFO  HybridDocumentParser   - 检测到表格（分数: {:.2f}），使用OCR解析以保留表格结构，文件: 0.704
25-11-27.16:36:02.977 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.16:36:03.019 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:36:03.362 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.16:36:47.364 [main            ] WARN  AliOcrProvider         - JSON解析失败，尝试修复。原始内容片段: {
  "pages": [
    {
      "page_no": 1,
      "image_size": [1200, 1600],
      "layout": [
        {
          "element_id": "e1_1",
          "parent_id": null,
          "type": "title",
          "heading_level": 1,
          "bbox": [345, 98, 635, 124],
          "text": "中国地质大学（武汉）",
        ...
25-11-27.16:36:47.367 [main            ] ERROR AliOcrProvider         - 解析响应内容失败
com.fasterxml.jackson.databind.JsonMappingException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:401)
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:360)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1964)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:401)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:361)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4917)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3860)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3828)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:502)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.recognize(AliOcrProvider.java:119)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognizeWithRetry(DefaultOcrService.java:121)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:89)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.recognizeSinglePage(HybridDocumentParser.java:495)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.serialOcrRecognize(HybridDocumentParser.java:478)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parallelOcrRecognize(HybridDocumentParser.java:434)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseWithOcr(HybridDocumentParser.java:363)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:239)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseAutoMode(HybridDocumentParser.java:197)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:124)
	at cn.cug.sxy.ai.test.domain.parsing.PdfParsingTest.testAutoModeParsing(PdfParsingTest.java:95)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10]
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportInvalidEOF(ParserMinimalBase.java:641)
	at com.fasterxml.jackson.core.base.ParserBase._handleEOF(ParserBase.java:530)
	at com.fasterxml.jackson.core.base.ParserBase._eofAsNextChar(ParserBase.java:547)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2490)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:352)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	... 93 common frames omitted
25-11-27.16:36:47.370 [main            ] WARN  DefaultOcrService      - Provider 阿里云DashScope (qwen3-vl-plus) 失败: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
25-11-27.16:36:47.370 [main            ] ERROR HybridDocumentParser   - 第 1 页OCR识别失败
cn.cug.sxy.ai.domain.rag.service.parsing.OcrService$OcrException: 所有OCR Provider均失败，最后一个错误: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:108)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.recognizeSinglePage(HybridDocumentParser.java:495)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.serialOcrRecognize(HybridDocumentParser.java:478)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parallelOcrRecognize(HybridDocumentParser.java:434)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseWithOcr(HybridDocumentParser.java:363)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:239)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseAutoMode(HybridDocumentParser.java:197)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:124)
	at cn.cug.sxy.ai.test.domain.parsing.PdfParsingTest.testAutoModeParsing(PdfParsingTest.java:95)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: cn.cug.sxy.ai.domain.rag.service.parsing.ocr.OcrProvider$OcrProviderException: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:527)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.recognize(AliOcrProvider.java:119)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognizeWithRetry(DefaultOcrService.java:121)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:89)
	... 78 common frames omitted
Caused by: com.fasterxml.jackson.databind.JsonMappingException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:401)
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:360)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1964)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:401)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:361)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4917)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3860)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3828)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:502)
	... 81 common frames omitted
Caused by: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10]
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportInvalidEOF(ParserMinimalBase.java:641)
	at com.fasterxml.jackson.core.base.ParserBase._handleEOF(ParserBase.java:530)
	at com.fasterxml.jackson.core.base.ParserBase._eofAsNextChar(ParserBase.java:547)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2490)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:352)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	... 93 common frames omitted
25-11-27.16:36:56.281 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.16:36:56.286 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:36:56.310 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=1, 元素数=1, 表格数=0, 平均置信度={:.2f}, 压缩比={:.2f}x, 处理时间=0.98ms
25-11-27.16:36:56.335 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.16:36:56.337 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.16:36:56.337 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.16:36:56.337 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.16:38:58.160 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.16:38:58.176 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 44507 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.16:38:58.176 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.16:38:58.628 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.16:38:58.628 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.16:38:58.648 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
25-11-27.16:38:59.136 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus
25-11-27.16:38:59.137 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.16:38:59.137 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.16:38:59.144 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.16:38:59.146 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.16:38:59.146 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.16:38:59.146 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.16:38:59.147 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.16:38:59.147 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.16:38:59.147 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.16:38:59.147 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.16:38:59.307 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.16:38:59.453 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.16:38:59.460 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.16:38:59.594 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@7146c6ea
25-11-27.16:38:59.594 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.16:38:59.626 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.16:38:59.626 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.16:38:59.626 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.16:38:59.626 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.16:38:59.628 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.16:38:59.632 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.16:38:59.633 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.16:39:00.001 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.16:39:00.002 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.16:39:00.008 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.16:39:00.009 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.16:39:00.014 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.16:39:00.033 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.16:39:00.034 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.16:39:00.642 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:39:00.871 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.16:39:01.023 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:39:01.162 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.16:39:01.416 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:39:01.560 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:39:01.728 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:39:01.939 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:39:02.090 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:39:02.220 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:39:02.442 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.16:39:02.589 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.16:39:02.732 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:39:02.965 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:39:03.136 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:39:03.298 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:39:03.491 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:39:03.646 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:39:03.792 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:39:04.014 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:39:04.173 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:39:04.322 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:39:04.592 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:39:04.748 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:39:04.908 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.16:39:05.234 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:39:05.590 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:39:05.793 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:39:05.924 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:39:06.110 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:39:06.279 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:39:06.406 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:39:06.634 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:39:06.768 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:39:06.928 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:39:07.159 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:39:07.289 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:39:07.441 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.16:39:07.684 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:39:07.821 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:39:07.983 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:39:08.144 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:39:08.280 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.16:39:08.327 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.16:39:08.327 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.16:39:08.332 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.16:39:08.386 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.16:39:08.548 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 10.561 seconds (process running for 11.156)
25-11-27.16:39:08.549 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.16:39:08.550 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.16:39:08.768 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@4e0a5606
25-11-27.16:39:08.769 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.16:39:08.779 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.16:39:08.779 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:39:08.780 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:39:08.780 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:39:08.780 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:39:08.780 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:39:08.781 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:39:09.344 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:39:09.350 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:39:09.350 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:39:09.350 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:39:09.350 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:39:09.350 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:39:09.350 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:39:09.350 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:39:09.457 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:39:09.457 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:39:09.458 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.16:39:09.458 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.16:39:09.458 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:39:09.924 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.16:39:09.925 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.16:39:09.938 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.16:39:09.941 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.16:39:09.942 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.16:39:10.308 [HttpClient-1-Worker-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.16:39:10.409 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.16:39:10.410 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.16:39:10.802 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.16:39:10.802 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.16:39:10.802 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.16:39:11.193 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.16:39:11.543 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.16:39:11.544 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.16:39:11.544 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:39:11.580 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.16:39:11.889 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.16:39:11.889 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:39:11.890 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.16:39:11.890 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.16:39:11.890 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.16:39:11.890 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.16:39:11.890 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.16:39:12.227 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 自动模式
25-11-27.16:39:16.540 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:39:16.561 [main            ] INFO  PdfTableDetector       - 表格检测完成: 文件=src/test/resources/pdfs/test_pdf_1.pdf, 页数=2, 检测到表格=true, 表格分数={:.2f}, 建议=0.704
25-11-27.16:39:16.562 [main            ] INFO  HybridDocumentParser   - 检测到表格（分数: 0.704），使用OCR解析以保留表格结构，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.16:39:16.562 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.16:39:16.599 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:39:16.960 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.16:41:07.831 [PostgresHikariPool housekeeper] WARN  HikariPool             - PostgresHikariPool - Thread starvation or clock leap detected (housekeeper delta=1m8s120ms).
25-11-27.16:41:07.831 [MySqlHikariPool housekeeper] WARN  HikariPool             - MySqlHikariPool - Thread starvation or clock leap detected (housekeeper delta=1m28s954ms).
25-11-27.16:43:05.898 [PostgresHikariPool housekeeper] WARN  HikariPool             - PostgresHikariPool - Thread starvation or clock leap detected (housekeeper delta=1m58s67ms).
25-11-27.16:43:05.898 [MySqlHikariPool housekeeper] WARN  HikariPool             - MySqlHikariPool - Thread starvation or clock leap detected (housekeeper delta=1m58s68ms).
25-11-27.16:43:05.912 [main            ] WARN  AliOcrProvider         - JSON解析失败，尝试修复。原始内容片段: {
  "pages": [
    {
      "page_no": 1,
      "image_size": [1200, 1600],
      "layout": [
        {
          "element_id": "e1_1",
          "parent_id": null,
          "type": "title",
          "heading_level": 1,
          "bbox": [348, 98, 635, 124],
          "text": "中国地质大学（武汉）",
        ...
25-11-27.16:43:05.914 [main            ] ERROR AliOcrProvider         - 解析响应内容失败
com.fasterxml.jackson.databind.JsonMappingException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:401)
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:360)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1964)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:401)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:361)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4917)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3860)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3828)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:502)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.recognize(AliOcrProvider.java:119)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognizeWithRetry(DefaultOcrService.java:121)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:89)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.recognizeSinglePage(HybridDocumentParser.java:495)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.serialOcrRecognize(HybridDocumentParser.java:478)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parallelOcrRecognize(HybridDocumentParser.java:434)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseWithOcr(HybridDocumentParser.java:363)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:239)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseAutoMode(HybridDocumentParser.java:197)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:124)
	at cn.cug.sxy.ai.test.domain.parsing.PdfParsingTest.testAutoModeParsing(PdfParsingTest.java:95)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10]
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportInvalidEOF(ParserMinimalBase.java:641)
	at com.fasterxml.jackson.core.base.ParserBase._handleEOF(ParserBase.java:530)
	at com.fasterxml.jackson.core.base.ParserBase._eofAsNextChar(ParserBase.java:547)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2490)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:352)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	... 93 common frames omitted
25-11-27.16:43:05.917 [main            ] WARN  DefaultOcrService      - Provider 阿里云DashScope (qwen3-vl-plus) 失败: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
25-11-27.16:43:05.917 [main            ] ERROR HybridDocumentParser   - 第 1 页OCR识别失败
cn.cug.sxy.ai.domain.rag.service.parsing.OcrService$OcrException: 所有OCR Provider均失败，最后一个错误: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:108)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.recognizeSinglePage(HybridDocumentParser.java:495)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.serialOcrRecognize(HybridDocumentParser.java:478)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parallelOcrRecognize(HybridDocumentParser.java:434)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseWithOcr(HybridDocumentParser.java:363)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:239)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseAutoMode(HybridDocumentParser.java:197)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:124)
	at cn.cug.sxy.ai.test.domain.parsing.PdfParsingTest.testAutoModeParsing(PdfParsingTest.java:95)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: cn.cug.sxy.ai.domain.rag.service.parsing.ocr.OcrProvider$OcrProviderException: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:527)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.recognize(AliOcrProvider.java:119)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognizeWithRetry(DefaultOcrService.java:121)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:89)
	... 78 common frames omitted
Caused by: com.fasterxml.jackson.databind.JsonMappingException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:401)
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:360)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1964)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:401)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:361)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4917)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3860)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3828)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:502)
	... 81 common frames omitted
Caused by: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10]
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportInvalidEOF(ParserMinimalBase.java:641)
	at com.fasterxml.jackson.core.base.ParserBase._handleEOF(ParserBase.java:530)
	at com.fasterxml.jackson.core.base.ParserBase._eofAsNextChar(ParserBase.java:547)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2490)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:352)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	... 93 common frames omitted
25-11-27.16:44:22.438 [PostgresHikariPool housekeeper] WARN  HikariPool             - PostgresHikariPool - Thread starvation or clock leap detected (housekeeper delta=1m16s540ms).
25-11-27.16:44:22.438 [MySqlHikariPool housekeeper] WARN  HikariPool             - MySqlHikariPool - Thread starvation or clock leap detected (housekeeper delta=1m16s540ms).
25-11-27.16:44:25.346 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.16:44:25.355 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:44:25.378 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=1, 元素数=2, 表格数=0, 平均置信度={:.2f}, 压缩比={:.2f}x, 处理时间=0.98ms
25-11-27.16:44:25.410 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.16:44:25.411 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.16:44:25.411 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.16:44:25.411 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.16:45:23.754 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.16:45:23.767 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 45146 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.16:45:23.768 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.16:45:24.238 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.16:45:24.239 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.16:45:24.265 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
25-11-27.16:45:24.724 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus
25-11-27.16:45:24.726 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.16:45:24.727 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.16:45:24.733 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.16:45:24.734 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.16:45:24.734 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.16:45:24.734 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.16:45:24.735 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.16:45:24.735 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.16:45:24.735 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.16:45:24.735 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.16:45:24.887 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.16:45:25.021 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.16:45:25.029 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.16:45:25.301 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@480994d3
25-11-27.16:45:25.302 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.16:45:25.328 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.16:45:25.328 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.16:45:25.328 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.16:45:25.328 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.16:45:25.330 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.16:45:25.334 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.16:45:25.334 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.16:45:25.850 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.16:45:25.851 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.16:45:25.858 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.16:45:25.859 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.16:45:25.865 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.16:45:25.883 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.16:45:25.884 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.16:45:26.435 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:45:26.567 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.16:45:26.750 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:45:26.921 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.16:45:27.083 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:45:27.273 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:45:27.423 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:45:27.566 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:45:27.799 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:45:27.970 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:45:28.117 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.16:45:28.320 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.16:45:28.455 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:45:28.598 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:45:28.849 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:45:28.985 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:45:29.121 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:45:29.368 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:45:29.524 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:45:29.656 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:45:29.894 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:45:30.038 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:45:30.196 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:45:30.417 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:45:30.591 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.16:45:30.732 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:45:30.942 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:45:31.093 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:45:31.260 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:45:31.467 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:45:31.613 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:45:31.772 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:45:31.994 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:45:32.140 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:45:32.283 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:45:32.513 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:45:32.796 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:45:33.036 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.16:45:33.614 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:45:33.762 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:45:33.895 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:45:34.085 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:45:34.308 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.16:45:34.350 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.16:45:34.350 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.16:45:34.355 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.16:45:34.411 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.16:45:34.571 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 11.007 seconds (process running for 11.592)
25-11-27.16:45:34.572 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.16:45:34.573 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.16:45:34.660 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@6ed78a5e
25-11-27.16:45:34.660 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.16:45:34.666 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.16:45:34.667 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:45:34.668 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.668 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.668 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.668 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.668 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.822 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:45:34.826 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:45:34.827 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:45:34.827 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.827 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.827 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.827 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.827 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:45:34.912 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:45:34.912 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:45:34.913 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.16:45:34.913 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.16:45:34.913 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:45:35.454 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.16:45:35.454 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.16:45:35.469 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.16:45:35.472 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.16:45:35.473 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.16:45:35.995 [HttpClient-1-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.16:45:36.180 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.16:45:36.181 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.16:45:36.703 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.16:45:36.703 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.16:45:36.703 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.16:45:37.237 [HttpClient-2-Worker-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.16:45:37.379 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.16:45:37.380 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.16:45:37.380 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:45:37.415 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.16:45:37.766 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.16:45:37.767 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:45:37.768 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.16:45:37.768 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.16:45:37.768 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.16:45:37.768 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.16:45:37.768 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.16:45:38.099 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 自动模式
25-11-27.16:45:38.193 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:45:38.212 [main            ] INFO  PdfTableDetector       - 表格检测完成: 文件=src/test/resources/pdfs/test_pdf_1.pdf, 页数=2, 检测到表格=true, 表格分数=0.704, 建议=USE_OCR
25-11-27.16:45:38.212 [main            ] INFO  HybridDocumentParser   - 检测到表格（分数: 0.704），使用OCR解析以保留表格结构，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.16:45:38.212 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.16:45:38.248 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:45:38.621 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.16:48:35.966 [MySqlHikariPool housekeeper] WARN  HikariPool             - MySqlHikariPool - Thread starvation or clock leap detected (housekeeper delta=1m53s711ms).
25-11-27.16:48:35.966 [PostgresHikariPool housekeeper] WARN  HikariPool             - PostgresHikariPool - Thread starvation or clock leap detected (housekeeper delta=2m10s551ms).
25-11-27.16:48:55.321 [main            ] WARN  AliOcrProvider         - JSON解析失败，尝试修复。原始内容片段: {
  "pages": [
    {
      "page_no": 1,
      "image_size": [1200, 1600],
      "layout": [
        {
          "element_id": "e1_1",
          "parent_id": null,
          "type": "title",
          "heading_level": 1,
          "bbox": [345, 98, 635, 124],
          "text": "中国地质大学（武汉）",
        ...
25-11-27.16:48:59.574 [main            ] ERROR AliOcrProvider         - 解析响应内容失败
com.fasterxml.jackson.databind.JsonMappingException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:401)
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:360)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1964)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:401)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:361)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4917)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3860)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3828)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:502)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.recognize(AliOcrProvider.java:119)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognizeWithRetry(DefaultOcrService.java:121)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:89)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.recognizeSinglePage(HybridDocumentParser.java:495)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.serialOcrRecognize(HybridDocumentParser.java:478)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parallelOcrRecognize(HybridDocumentParser.java:434)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseWithOcr(HybridDocumentParser.java:363)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:239)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseAutoMode(HybridDocumentParser.java:197)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:124)
	at cn.cug.sxy.ai.test.domain.parsing.PdfParsingTest.testAutoModeParsing(PdfParsingTest.java:95)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10]
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportInvalidEOF(ParserMinimalBase.java:641)
	at com.fasterxml.jackson.core.base.ParserBase._handleEOF(ParserBase.java:530)
	at com.fasterxml.jackson.core.base.ParserBase._eofAsNextChar(ParserBase.java:547)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2490)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:352)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	... 93 common frames omitted
25-11-27.16:49:59.454 [PostgresHikariPool housekeeper] WARN  HikariPool             - PostgresHikariPool - Thread starvation or clock leap detected (housekeeper delta=53s391ms).
25-11-27.16:49:59.454 [MySqlHikariPool housekeeper] WARN  HikariPool             - MySqlHikariPool - Thread starvation or clock leap detected (housekeeper delta=53s391ms).
25-11-27.16:49:59.457 [main            ] WARN  DefaultOcrService      - Provider 阿里云DashScope (qwen3-vl-plus) 失败: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
25-11-27.16:49:59.458 [main            ] ERROR HybridDocumentParser   - 第 1 页OCR识别失败
cn.cug.sxy.ai.domain.rag.service.parsing.OcrService$OcrException: 所有OCR Provider均失败，最后一个错误: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:108)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.recognizeSinglePage(HybridDocumentParser.java:495)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.serialOcrRecognize(HybridDocumentParser.java:478)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parallelOcrRecognize(HybridDocumentParser.java:434)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseWithOcr(HybridDocumentParser.java:363)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:239)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseAutoMode(HybridDocumentParser.java:197)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:124)
	at cn.cug.sxy.ai.test.domain.parsing.PdfParsingTest.testAutoModeParsing(PdfParsingTest.java:95)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: cn.cug.sxy.ai.domain.rag.service.parsing.ocr.OcrProvider$OcrProviderException: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:527)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.recognize(AliOcrProvider.java:119)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognizeWithRetry(DefaultOcrService.java:121)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:89)
	... 78 common frames omitted
Caused by: com.fasterxml.jackson.databind.JsonMappingException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:401)
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:360)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1964)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:401)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:361)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4917)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3860)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3828)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:502)
	... 81 common frames omitted
Caused by: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10]
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportInvalidEOF(ParserMinimalBase.java:641)
	at com.fasterxml.jackson.core.base.ParserBase._handleEOF(ParserBase.java:530)
	at com.fasterxml.jackson.core.base.ParserBase._eofAsNextChar(ParserBase.java:547)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2490)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:352)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	... 93 common frames omitted
25-11-27.16:52:28.930 [MySqlHikariPool housekeeper] WARN  HikariPool             - MySqlHikariPool - Thread starvation or clock leap detected (housekeeper delta=1m45s283ms).
25-11-27.16:52:28.930 [PostgresHikariPool housekeeper] WARN  HikariPool             - PostgresHikariPool - Thread starvation or clock leap detected (housekeeper delta=1m45s283ms).
25-11-27.16:52:36.801 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.16:52:36.804 [lettuce-eventExecutorLoop-1-4] INFO  ConnectionWatchdog     - Reconnecting, last destination was /192.168.2.219:6380
25-11-27.16:52:36.804 [lettuce-eventExecutorLoop-1-5] INFO  ConnectionWatchdog     - Reconnecting, last destination was /192.168.2.219:6380
25-11-27.16:52:36.805 [lettuce-eventExecutorLoop-1-3] INFO  ConnectionWatchdog     - Reconnecting, last destination was /192.168.2.219:6380
25-11-27.16:52:36.805 [lettuce-eventExecutorLoop-1-2] INFO  ConnectionWatchdog     - Reconnecting, last destination was /192.168.2.219:6380
25-11-27.16:52:36.810 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:52:36.826 [lettuce-nioEventLoop-4-8] INFO  ReconnectionHandler    - Reconnected to 192.168.2.219/<unresolved>:6380
25-11-27.16:52:36.826 [lettuce-nioEventLoop-4-9] INFO  ReconnectionHandler    - Reconnected to 192.168.2.219/<unresolved>:6380
25-11-27.16:52:36.826 [lettuce-nioEventLoop-4-6] INFO  ReconnectionHandler    - Reconnected to 192.168.2.219/<unresolved>:6380
25-11-27.16:52:36.826 [lettuce-nioEventLoop-4-7] INFO  ReconnectionHandler    - Reconnected to 192.168.2.219/<unresolved>:6380
25-11-27.16:52:36.829 [lettuce-eventExecutorLoop-1-6] INFO  ConnectionWatchdog     - Reconnecting, last destination was /192.168.2.219:6380
25-11-27.16:52:36.835 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=1, 元素数=1, 表格数=0, 平均置信度={:.2f}, 压缩比={:.2f}x, 处理时间=0.98ms
25-11-27.16:52:36.844 [lettuce-nioEventLoop-4-10] INFO  ReconnectionHandler    - Reconnected to 192.168.2.219/<unresolved>:6380
25-11-27.16:52:36.859 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.16:52:36.860 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.16:52:36.860 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.16:52:36.860 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.16:53:46.574 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.16:53:46.592 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 45915 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.16:53:46.593 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.16:53:47.043 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.16:53:47.044 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.16:53:47.059 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
25-11-27.16:53:47.505 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus
25-11-27.16:53:47.506 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.16:53:47.506 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.16:53:47.515 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.16:53:47.516 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.16:53:47.516 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.16:53:47.516 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.16:53:47.517 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.16:53:47.517 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.16:53:47.517 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.16:53:47.517 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.16:53:47.659 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.16:53:47.793 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.16:53:47.799 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.16:53:48.052 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@3aa1c45
25-11-27.16:53:48.053 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.16:53:48.069 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.16:53:48.069 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.16:53:48.069 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.16:53:48.069 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.16:53:48.071 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.16:53:48.075 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.16:53:48.075 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.16:53:48.534 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.16:53:48.537 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.16:53:48.544 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.16:53:48.544 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.16:53:48.549 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.16:53:48.567 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.16:53:48.568 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.16:53:49.066 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:53:49.231 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.16:53:49.358 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:53:49.555 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.16:53:49.710 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:53:49.859 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:53:50.076 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:53:50.215 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:53:50.341 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:53:50.600 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:53:50.762 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.16:53:50.911 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.16:53:51.123 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:53:51.266 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:53:51.417 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:53:51.648 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:53:51.797 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:53:51.950 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:53:52.173 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:53:52.340 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:53:52.471 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:53:53.291 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:53:53.452 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:53:53.747 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:53:53.889 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.16:53:54.102 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:53:54.267 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:53:54.414 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:53:54.562 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:53:54.795 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:53:54.947 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:53:55.134 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:53:55.318 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:53:55.512 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:53:55.685 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:53:55.996 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:53:56.141 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:53:56.373 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.16:53:56.529 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:53:56.687 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:53:56.894 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:53:57.051 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:53:57.199 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.16:53:57.231 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.16:53:57.231 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.16:53:57.237 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.16:53:57.289 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.16:53:57.430 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 11.023 seconds (process running for 11.589)
25-11-27.16:53:57.431 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.16:53:57.433 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.16:53:57.507 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@41dbf02b
25-11-27.16:53:57.507 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.16:53:57.518 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.16:53:57.519 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:53:57.519 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.519 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.520 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.520 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.520 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.701 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:53:57.706 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:53:57.706 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:53:57.706 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.706 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.706 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.707 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.707 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:53:57.780 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:53:57.780 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:53:57.782 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.16:53:57.782 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.16:53:57.782 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:53:58.276 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.16:53:58.276 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.16:53:58.293 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.16:53:58.295 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.16:53:58.296 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.16:53:58.838 [HttpClient-1-Worker-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.16:53:59.066 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.16:53:59.067 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.16:53:59.545 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.16:53:59.545 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.16:53:59.545 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.16:54:00.043 [HttpClient-2-Worker-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.16:54:00.218 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.16:54:00.219 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.16:54:00.219 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:54:00.253 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.16:54:00.575 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.16:54:00.575 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:54:00.577 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.16:54:00.577 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.16:54:00.577 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.16:54:00.578 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.16:54:00.578 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.16:54:00.795 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 自动模式
25-11-27.16:54:00.877 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:54:00.896 [main            ] INFO  PdfTableDetector       - 表格检测完成: 文件=src/test/resources/pdfs/test_pdf_1.pdf, 页数=2, 检测到表格=true, 表格分数=0.704, 建议=USE_OCR
25-11-27.16:54:00.897 [main            ] INFO  HybridDocumentParser   - 检测到表格（分数: 0.704），使用OCR解析以保留表格结构，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.16:54:00.897 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.16:54:00.933 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:54:01.286 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.16:54:53.877 [main            ] WARN  AliOcrProvider         - JSON解析失败，尝试修复。原始内容片段: {
  "pages": [
    {
      "page_no": 1,
      "image_size": [1200, 1600],
      "layout": [
        {
          "element_id": "e1_1",
          "parent_id": null,
          "type": "title",
          "heading_level": 1,
          "bbox": [348, 98, 635, 124],
          "text": "中国地质大学（武汉）",
        ...
25-11-27.16:54:53.879 [main            ] ERROR AliOcrProvider         - 解析响应内容失败
com.fasterxml.jackson.databind.JsonMappingException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:401)
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:360)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1964)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:401)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:361)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4917)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3860)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3828)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:502)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.recognize(AliOcrProvider.java:119)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognizeWithRetry(DefaultOcrService.java:121)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:89)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.recognizeSinglePage(HybridDocumentParser.java:495)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.serialOcrRecognize(HybridDocumentParser.java:478)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parallelOcrRecognize(HybridDocumentParser.java:434)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseWithOcr(HybridDocumentParser.java:363)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:239)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseAutoMode(HybridDocumentParser.java:197)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:124)
	at cn.cug.sxy.ai.test.domain.parsing.PdfParsingTest.testAutoModeParsing(PdfParsingTest.java:95)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10]
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportInvalidEOF(ParserMinimalBase.java:641)
	at com.fasterxml.jackson.core.base.ParserBase._handleEOF(ParserBase.java:530)
	at com.fasterxml.jackson.core.base.ParserBase._eofAsNextChar(ParserBase.java:547)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2490)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:352)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	... 93 common frames omitted
25-11-27.16:54:53.883 [main            ] WARN  DefaultOcrService      - Provider 阿里云DashScope (qwen3-vl-plus) 失败: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
25-11-27.16:54:53.883 [main            ] ERROR HybridDocumentParser   - 第 1 页OCR识别失败
cn.cug.sxy.ai.domain.rag.service.parsing.OcrService$OcrException: 所有OCR Provider均失败，最后一个错误: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:108)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.recognizeSinglePage(HybridDocumentParser.java:495)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.serialOcrRecognize(HybridDocumentParser.java:478)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parallelOcrRecognize(HybridDocumentParser.java:434)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseWithOcr(HybridDocumentParser.java:363)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:239)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseAutoMode(HybridDocumentParser.java:197)
	at cn.cug.sxy.ai.domain.rag.service.parsing.HybridDocumentParser.parseFromFile(HybridDocumentParser.java:124)
	at cn.cug.sxy.ai.test.domain.parsing.PdfParsingTest.testAutoModeParsing(PdfParsingTest.java:95)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: cn.cug.sxy.ai.domain.rag.service.parsing.ocr.OcrProvider$OcrProviderException: 解析响应内容失败: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:527)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.recognize(AliOcrProvider.java:119)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognizeWithRetry(DefaultOcrService.java:121)
	at cn.cug.sxy.ai.domain.rag.service.parsing.DefaultOcrService.recognize(DefaultOcrService.java:89)
	... 78 common frames omitted
Caused by: com.fasterxml.jackson.databind.JsonMappingException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10] (through reference chain: cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument["pages"]->java.util.ArrayList[0]->cn.cug.sxy.ai.domain.rag.model.parsing.StructuredDocument$Page["layout"])
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:401)
	at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:360)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1964)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:401)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:361)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4917)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3860)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3828)
	at cn.cug.sxy.ai.domain.rag.service.parsing.ocr.AliOcrProvider.parseResponseContent(AliOcrProvider.java:502)
	... 81 common frames omitted
Caused by: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 6, column: 17])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 42, column: 10]
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportInvalidEOF(ParserMinimalBase.java:641)
	at com.fasterxml.jackson.core.base.ParserBase._handleEOF(ParserBase.java:530)
	at com.fasterxml.jackson.core.base.ParserBase._eofAsNextChar(ParserBase.java:547)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2490)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:352)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:246)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:30)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:399)
	... 93 common frames omitted
25-11-27.16:55:03.149 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.16:55:03.156 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.16:55:03.180 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=1, 元素数=1, 表格数=0, 平均置信度={:.2f}, 压缩比={:.2f}x, 处理时间=0.98ms
25-11-27.16:55:03.205 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.16:55:03.205 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.16:55:03.205 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.16:55:03.206 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.16:58:43.142 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.16:58:43.156 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 46444 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.16:58:43.157 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.16:58:43.566 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.16:58:43.566 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.16:58:43.583 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
25-11-27.16:58:44.028 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus, 最大Token: 8192
25-11-27.16:58:44.029 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.16:58:44.029 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.16:58:44.038 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.16:58:44.040 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.16:58:44.040 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.16:58:44.040 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.16:58:44.040 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.16:58:44.040 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.16:58:44.040 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.16:58:44.040 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.16:58:44.189 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.16:58:44.329 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.16:58:44.339 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.16:58:44.506 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@4a18e0f1
25-11-27.16:58:44.507 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.16:58:44.529 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.16:58:44.529 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.16:58:44.529 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.16:58:44.529 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.16:58:44.531 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.16:58:44.535 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.16:58:44.535 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.16:58:44.939 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.16:58:44.940 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.16:58:44.945 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.16:58:44.946 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.16:58:44.950 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.16:58:44.972 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.16:58:44.973 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.16:58:45.563 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:58:45.799 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.16:58:45.978 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:58:46.123 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.16:58:46.393 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:58:46.539 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:58:46.845 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:58:47.030 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:58:47.178 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:58:47.369 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:58:47.514 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.16:58:47.653 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.16:58:47.891 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.16:58:48.041 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:58:48.189 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:58:48.415 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:58:48.556 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:58:48.701 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:58:48.944 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:58:49.106 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:58:49.306 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:58:49.686 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:58:49.834 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:58:50.117 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.16:58:50.257 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.16:58:50.528 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.16:58:50.718 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:58:50.874 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.16:58:51.039 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:58:51.178 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.16:58:51.337 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.16:58:51.564 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.16:58:51.708 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:58:51.853 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:58:52.087 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:58:52.263 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:58:52.430 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.16:58:52.610 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.16:58:52.771 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:58:52.899 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:58:53.132 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.16:58:53.284 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.16:58:53.434 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.16:58:53.478 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.16:58:53.478 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.16:58:53.491 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.16:58:53.541 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.16:58:53.683 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 10.723 seconds (process running for 11.317)
25-11-27.16:58:53.685 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.16:58:53.686 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.16:58:53.818 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@45ed58b
25-11-27.16:58:53.818 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.16:58:53.825 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.16:58:53.825 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:58:53.826 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:58:53.826 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:58:53.826 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:58:53.826 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:58:53.826 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:58:54.023 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:58:54.028 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:58:54.028 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.16:58:54.028 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.16:58:54.028 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.16:58:54.028 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.16:58:54.028 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.16:58:54.028 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.16:58:54.250 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.16:58:54.250 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:58:54.251 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.16:58:54.252 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.16:58:54.252 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:58:54.960 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.16:58:54.960 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.16:58:54.974 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.16:58:54.977 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.16:58:54.978 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.16:58:55.378 [HttpClient-1-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.16:58:55.480 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.16:58:55.480 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.16:58:56.012 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.16:58:56.012 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.16:58:56.012 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.16:58:56.528 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.16:58:56.803 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.16:58:56.804 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.16:58:56.804 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:58:56.839 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.16:58:57.047 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.16:58:57.048 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.16:58:57.049 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.16:58:57.049 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.16:58:57.049 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.16:58:57.049 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.16:58:57.049 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.16:58:57.298 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.16:58:57.300 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.16:58:57.300 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.16:58:57.301 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.17:00:24.902 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.17:00:24.913 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 46656 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.17:00:24.913 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.17:00:25.267 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.17:00:25.268 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.17:00:25.284 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
25-11-27.17:00:25.709 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus, 最大Token: 8192
25-11-27.17:00:25.710 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.17:00:25.710 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.17:00:25.718 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.17:00:25.721 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.17:00:25.721 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.17:00:25.721 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.17:00:25.721 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.17:00:25.721 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.17:00:25.721 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.17:00:25.721 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.17:00:25.873 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.17:00:25.991 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.17:00:25.998 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.17:00:26.128 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@574327ed
25-11-27.17:00:26.129 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.17:00:26.148 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.17:00:26.148 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.17:00:26.148 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.17:00:26.148 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.17:00:26.150 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.17:00:26.153 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.17:00:26.153 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.17:00:26.583 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.17:00:26.584 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.17:00:26.589 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.17:00:26.589 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.17:00:26.593 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.17:00:26.611 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.17:00:26.612 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.17:00:27.068 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:00:27.198 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.17:00:27.337 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:00:27.513 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.17:00:27.739 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:00:28.035 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:00:28.188 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:00:28.562 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:00:28.729 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:00:28.901 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:00:29.086 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.17:00:29.440 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.17:00:29.616 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:00:30.161 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:00:30.314 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:00:30.451 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:00:30.658 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:00:30.820 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:00:30.973 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:00:31.179 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:00:31.311 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:00:31.458 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:00:31.705 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:00:31.857 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:00:32.013 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.17:00:32.232 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:00:32.373 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:00:32.507 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:00:32.751 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:00:32.888 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:00:33.039 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:00:33.278 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:00:33.421 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:00:33.568 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:00:33.803 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:00:33.988 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:00:34.177 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:00:34.459 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.17:00:34.695 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:00:35.068 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:00:35.203 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:00:35.376 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:00:35.538 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.17:00:35.582 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.17:00:35.582 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.17:00:35.588 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.17:00:35.648 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.17:00:35.798 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 11.031 seconds (process running for 11.445)
25-11-27.17:00:35.799 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.17:00:35.800 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.17:00:35.945 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@4fc00158
25-11-27.17:00:35.945 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.17:00:35.952 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.17:00:35.953 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:00:35.953 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:00:35.953 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:00:35.953 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:00:35.953 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:00:35.953 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:00:36.115 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:00:36.120 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:00:36.120 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:00:36.120 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:00:36.120 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:00:36.120 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:00:36.120 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:00:36.120 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:00:36.209 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:00:36.209 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:00:36.210 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.17:00:36.210 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.17:00:36.211 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:00:36.672 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.17:00:36.672 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.17:00:36.687 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.17:00:36.690 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.17:00:36.691 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.17:00:37.095 [HttpClient-1-Worker-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.17:00:37.195 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.17:00:37.195 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.17:00:37.797 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.17:00:37.798 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.17:00:37.798 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.17:00:38.523 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.17:00:38.661 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.17:00:38.662 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.17:00:38.662 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:00:38.697 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.17:00:39.051 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.17:00:39.051 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:00:39.052 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.17:00:39.052 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.17:00:39.052 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.17:00:39.052 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.17:00:39.052 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.17:00:39.271 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 自动模式
25-11-27.17:00:39.356 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:00:39.377 [main            ] INFO  PdfTableDetector       - 表格检测完成: 文件=src/test/resources/pdfs/test_pdf_1.pdf, 页数=2, 检测到表格=true, 表格分数={:.2f}, 建议=0.704
25-11-27.17:00:39.377 [main            ] INFO  HybridDocumentParser   - 检测到表格（分数: {:.2f}），使用OCR解析以保留表格结构，文件: 0.704
25-11-27.17:00:39.377 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.17:00:39.415 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:00:39.809 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.17:00:39.809 [main            ] INFO  HybridDocumentParser   - 开始串行OCR处理，总页数: 2
25-11-27.17:01:34.221 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:01:43.532 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:01:43.532 [main            ] INFO  HybridDocumentParser   - 串行OCR处理完成，成功: 2/2 页，失败: 0 页
25-11-27.17:01:43.538 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:01:43.567 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=2, 元素数=6, 表格数=1, 平均置信度={:.2f}, 压缩比={:.2f}x, 处理时间=0.9633333333333334ms
25-11-27.17:01:43.591 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.17:01:43.591 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.17:01:43.592 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.17:01:43.592 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.17:02:43.488 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.17:02:43.502 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 46909 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.17:02:43.502 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.17:02:43.948 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.17:02:43.949 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.17:02:43.970 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
25-11-27.17:02:44.424 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus, 最大Token: 8192
25-11-27.17:02:44.425 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.17:02:44.425 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.17:02:44.431 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.17:02:44.433 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.17:02:44.433 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.17:02:44.433 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.17:02:44.433 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.17:02:44.433 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.17:02:44.433 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.17:02:44.433 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.17:02:44.583 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.17:02:44.721 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.17:02:44.728 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.17:02:44.985 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@7146c6ea
25-11-27.17:02:44.986 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.17:02:45.018 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.17:02:45.018 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.17:02:45.019 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.17:02:45.019 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.17:02:45.020 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.17:02:45.023 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.17:02:45.023 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.17:02:45.586 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.17:02:45.587 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.17:02:45.593 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.17:02:45.593 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.17:02:45.598 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.17:02:45.615 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.17:02:45.615 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.17:02:46.130 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:02:46.289 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.17:02:46.450 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:02:46.583 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.17:02:46.718 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:02:46.978 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:02:47.150 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:02:47.326 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:02:47.500 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:02:47.676 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:02:47.842 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.17:02:48.032 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.17:02:48.176 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:02:48.335 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:02:48.548 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:02:48.688 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:02:48.835 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:02:49.080 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:02:49.219 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:02:49.386 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:02:49.600 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:02:49.747 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:02:49.968 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:02:50.258 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:02:50.421 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.17:02:50.654 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:02:51.401 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:02:51.695 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:02:51.838 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:02:51.967 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:02:52.227 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:02:52.355 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:02:52.505 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:02:52.740 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:02:52.887 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:02:53.023 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:02:53.265 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:02:53.433 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.17:02:53.568 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:02:53.787 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:02:53.928 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:02:54.061 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:02:54.312 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.17:02:54.357 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.17:02:54.357 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.17:02:54.362 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.17:02:54.418 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.17:02:54.573 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 11.266 seconds (process running for 11.874)
25-11-27.17:02:54.574 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.17:02:54.575 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.17:02:54.656 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@4e0a5606
25-11-27.17:02:54.659 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.17:02:54.667 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.17:02:54.667 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:02:54.668 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:02:54.668 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:02:54.668 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:02:54.669 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:02:54.669 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:02:54.979 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:02:54.984 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:02:54.984 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:02:54.984 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:02:54.984 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:02:54.984 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:02:54.984 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:02:54.984 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:02:55.062 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:02:55.062 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:02:55.064 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.17:02:55.064 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.17:02:55.064 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:02:55.536 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.17:02:55.536 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.17:02:55.551 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.17:02:55.554 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.17:02:55.555 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.17:02:55.887 [HttpClient-1-Worker-2] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.17:02:55.975 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.17:02:55.975 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.17:02:56.370 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.17:02:56.371 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.17:02:56.371 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.17:02:56.941 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.17:02:57.048 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.17:02:57.049 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.17:02:57.049 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:02:57.087 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.17:02:57.272 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.17:02:57.273 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:02:57.273 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.17:02:57.274 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.17:02:57.274 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.17:02:57.274 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.17:02:57.274 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.17:02:57.601 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 自动模式
25-11-27.17:02:57.697 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:02:57.717 [main            ] INFO  PdfTableDetector       - 表格检测完成: 文件=src/test/resources/pdfs/test_pdf_1.pdf, 页数=2, 检测到表格=true, 表格分数={:.2f}, 建议=0.704
25-11-27.17:02:57.717 [main            ] INFO  HybridDocumentParser   - 检测到表格（分数: 0.704），使用OCR解析以保留表格结构，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.17:02:57.717 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.17:02:57.750 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:02:58.158 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.17:02:58.159 [main            ] INFO  HybridDocumentParser   - 开始串行OCR处理，总页数: 2
25-11-27.17:03:42.710 [main            ] WARN  AliOcrProvider         - JSON响应被截断（完整模式），原因: 大括号不平衡，差值: 2，尝试简化模式
25-11-27.17:04:31.151 [main            ] INFO  AliOcrProvider         - 阿里云OCR识别成功（简化模式），页面数: 1
25-11-27.17:04:31.155 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:04:41.879 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:04:41.879 [main            ] INFO  HybridDocumentParser   - 串行OCR处理完成，成功: 2/2 页，失败: 0 页
25-11-27.17:04:41.885 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:04:41.912 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=2, 元素数=5, 表格数=0, 平均置信度={:.2f}, 压缩比={:.2f}x, 处理时间=0.962ms
25-11-27.17:04:41.937 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.17:04:41.937 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.17:04:41.938 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.17:04:41.938 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.17:12:05.209 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.17:12:05.223 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 47805 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.17:12:05.224 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.17:12:05.648 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.17:12:05.649 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.17:12:05.666 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
25-11-27.17:12:06.129 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus, 最大Token: 16384
25-11-27.17:12:06.130 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.17:12:06.130 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.17:12:06.136 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.17:12:06.138 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.17:12:06.138 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.17:12:06.138 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.17:12:06.138 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.17:12:06.138 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.17:12:06.138 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.17:12:06.138 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.17:12:06.284 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.17:12:06.424 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.17:12:06.433 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.17:12:06.583 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@3f6d36eb
25-11-27.17:12:06.583 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.17:12:06.606 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.17:12:06.606 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.17:12:06.606 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.17:12:06.606 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.17:12:06.608 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.17:12:06.611 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.17:12:06.611 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.17:12:07.120 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.17:12:07.121 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.17:12:07.126 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.17:12:07.126 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.17:12:07.131 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.17:12:07.146 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.17:12:07.147 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.17:12:07.737 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:12:07.978 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.17:12:08.133 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:12:08.292 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.17:12:08.496 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:12:08.646 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:12:08.806 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:12:09.020 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:12:09.189 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:12:09.349 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:12:09.543 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.17:12:09.704 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.17:12:09.853 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:12:10.069 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:12:10.226 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:12:10.438 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:12:10.746 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:12:10.885 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:12:11.130 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:12:11.276 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:12:11.433 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:12:11.639 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:12:11.819 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:12:11.944 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:12:12.163 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.17:12:12.374 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:12:12.518 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:12:12.694 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:12:12.845 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:12:12.978 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:12:13.214 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:12:13.350 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:12:13.498 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:12:13.737 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:12:13.894 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:12:14.051 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:12:14.260 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:12:14.413 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.17:12:14.570 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:12:14.788 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:12:14.946 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:12:15.097 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:12:15.309 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.17:12:15.340 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.17:12:15.340 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.17:12:15.346 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.17:12:15.399 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.17:12:15.544 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 10.488 seconds (process running for 10.993)
25-11-27.17:12:15.545 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.17:12:15.547 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.17:12:15.621 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@16ecdb6d
25-11-27.17:12:15.621 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.17:12:15.628 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.17:12:15.628 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:12:15.628 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:12:15.628 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:12:15.629 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:12:15.629 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:12:15.629 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:12:15.956 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:12:15.961 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:12:15.961 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:12:15.961 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:12:15.961 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:12:15.961 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:12:15.961 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:12:15.961 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:12:16.068 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:12:16.068 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:12:16.069 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.17:12:16.069 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.17:12:16.069 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:12:16.584 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.17:12:16.584 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.17:12:16.599 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.17:12:16.602 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.17:12:16.603 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.17:12:17.038 [HttpClient-1-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.17:12:17.134 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.17:12:17.134 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.17:12:17.766 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.17:12:17.766 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.17:12:17.766 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.17:12:18.286 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.17:12:18.453 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.17:12:18.454 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.17:12:18.454 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:12:18.489 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.17:12:18.730 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.17:12:18.730 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:12:18.731 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.17:12:18.732 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.17:12:18.732 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.17:12:18.732 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.17:12:18.732 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.17:12:18.958 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 自动模式
25-11-27.17:12:19.040 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:12:19.058 [main            ] INFO  PdfTableDetector       - 表格检测完成: 文件=src/test/resources/pdfs/test_pdf_1.pdf, 页数=2, 检测到表格=true, 表格分数=0.704, 建议=USE_OCR
25-11-27.17:12:19.059 [main            ] INFO  HybridDocumentParser   - 检测到表格（分数: 0.704），使用OCR解析以保留表格结构，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.17:12:19.059 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.17:12:19.099 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:12:19.454 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.17:12:19.455 [main            ] INFO  HybridDocumentParser   - 开始串行OCR处理，总页数: 2
25-11-27.17:12:58.023 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:13:03.839 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:13:03.839 [main            ] INFO  HybridDocumentParser   - 串行OCR处理完成，成功: 2/2 页，失败: 0 页
25-11-27.17:13:03.846 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:13:03.872 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=2, 元素数=5, 表格数=1, 平均置信度=0.9719999999999999, 压缩比=1.0833333333333333x, 处理时间=44813ms
25-11-27.17:13:03.896 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.17:13:03.898 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.17:13:03.899 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.17:13:03.899 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.17:16:31.135 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.17:16:31.149 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 48252 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.17:16:31.149 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.17:16:31.583 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.17:16:31.584 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.17:16:31.603 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
25-11-27.17:16:32.047 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus, 最大Token: 16384
25-11-27.17:16:32.048 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.17:16:32.048 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.17:16:32.056 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.17:16:32.058 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.17:16:32.058 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.17:16:32.058 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.17:16:32.058 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.17:16:32.058 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.17:16:32.058 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.17:16:32.058 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.17:16:32.218 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.17:16:32.351 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.17:16:32.358 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.17:16:32.483 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@6d45dd4
25-11-27.17:16:32.483 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.17:16:32.500 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.17:16:32.500 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.17:16:32.500 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.17:16:32.500 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.17:16:32.502 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.17:16:32.505 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.17:16:32.505 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.17:16:32.916 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.17:16:32.917 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.17:16:32.922 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.17:16:32.922 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.17:16:32.927 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.17:16:32.944 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.17:16:32.945 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.17:16:33.525 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:16:33.796 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.17:16:33.939 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:16:34.098 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.17:16:34.314 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:16:34.484 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:16:34.631 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:16:34.839 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:16:35.002 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:16:35.155 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:16:35.367 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.17:16:35.514 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.17:16:35.657 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:16:35.925 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:16:36.113 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:16:36.416 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:16:36.632 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:16:36.939 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:16:37.111 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:16:37.278 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:16:37.463 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:16:38.061 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:16:38.205 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:16:38.350 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:16:38.512 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.17:16:38.653 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:16:38.835 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:16:39.051 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:16:39.201 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:16:39.345 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:16:39.561 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:16:39.683 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:16:39.811 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:16:40.086 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:16:40.414 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:16:40.607 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:16:40.765 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:16:40.917 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.17:16:41.136 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:16:41.309 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:16:41.452 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:16:41.658 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:16:41.833 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.17:16:41.879 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.17:16:41.879 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.17:16:41.885 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.17:16:41.940 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.17:16:42.079 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 11.104 seconds (process running for 11.579)
25-11-27.17:16:42.080 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.17:16:42.082 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.17:16:42.223 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@6a28d987
25-11-27.17:16:42.223 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.17:16:42.230 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.17:16:42.231 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:16:42.231 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.231 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.231 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.232 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.232 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.398 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:16:42.403 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:16:42.403 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:16:42.403 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.403 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.403 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.403 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.403 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:16:42.499 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:16:42.499 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:16:42.500 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.17:16:42.500 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.17:16:42.500 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:16:42.985 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.17:16:42.985 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.17:16:43.000 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.17:16:43.003 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.17:16:43.004 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.17:16:43.350 [HttpClient-1-Worker-2] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.17:16:43.458 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.17:16:43.458 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.17:16:44.000 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.17:16:44.000 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.17:16:44.000 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.17:16:44.444 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.17:16:44.620 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.17:16:44.620 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.17:16:44.621 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:16:44.655 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.17:16:45.054 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.17:16:45.054 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:16:45.056 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.17:16:45.057 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.17:16:45.057 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.17:16:45.057 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.17:16:45.057 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.17:16:45.289 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_1.pdf, 模式: 自动模式
25-11-27.17:16:45.373 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:16:45.394 [main            ] INFO  PdfTableDetector       - 表格检测完成: 文件=src/test/resources/pdfs/test_pdf_1.pdf, 页数=2, 检测到表格=true, 表格分数=0.704, 建议=USE_OCR
25-11-27.17:16:45.394 [main            ] INFO  HybridDocumentParser   - 检测到表格（分数: 0.704），使用OCR解析以保留表格结构，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.17:16:45.394 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_1.pdf
25-11-27.17:16:45.430 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:16:45.790 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.17:16:45.790 [main            ] INFO  HybridDocumentParser   - 开始串行OCR处理，总页数: 2
25-11-27.17:17:32.551 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:17:41.425 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:17:41.425 [main            ] INFO  HybridDocumentParser   - 串行OCR处理完成，成功: 2/2 页，失败: 0 页
25-11-27.17:17:41.431 [main            ] WARN  PostScriptTable        - No PostScript name data is provided for the font WenQuanYiZenHei
25-11-27.17:17:41.459 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=2, 元素数=5, 表格数=1, 平均置信度=0.968, 压缩比=1.0833333333333333x, 处理时间=56065ms
25-11-27.17:17:41.481 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.17:17:41.483 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.17:17:41.483 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.17:17:41.484 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
25-11-27.17:23:29.284 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 8.0.2.Final
25-11-27.17:23:29.294 [main            ] INFO  PdfParsingTest         - Starting PdfParsingTest using Java 17.0.14 with PID 48931 (started by jerryhotton in /Users/jerryhotton/IdeaProjects/rag-system)
25-11-27.17:23:29.295 [main            ] INFO  PdfParsingTest         - No active profile set, falling back to 1 default profile: "default"
25-11-27.17:23:29.667 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-27.17:23:29.668 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-27.17:23:29.705 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 23 ms. Found 0 Redis repository interfaces.
25-11-27.17:23:30.135 [main            ] INFO  AliOcrProvider         - 阿里云OCR提供者初始化成功，模型: qwen3-vl-plus, 最大Token: 16384
25-11-27.17:23:30.136 [main            ] INFO  DefaultOcrService      - OCR服务初始化完成，已注册 1 个Provider:
25-11-27.17:23:30.136 [main            ] INFO  DefaultOcrService      -   - 阿里云DashScope (qwen3-vl-plus) (优先级: 10, 可用: true)
25-11-27.17:23:30.142 [main            ] INFO  HybridDocumentParser   - HybridDocumentParser初始化完成，并行页面数: 0, 置信度阈值: 0.0, 表格检测: false
25-11-27.17:23:30.145 [main            ] INFO  DocumentLoaderFactory  - Registered ExcelDocumentLoader for extensions: xlsx, xls
25-11-27.17:23:30.145 [main            ] INFO  DocumentLoaderFactory  - Registered HtmlDocumentLoader for extensions: html, htm
25-11-27.17:23:30.145 [main            ] INFO  DocumentLoaderFactory  - Registered ImageDocumentLoader for extensions: png, jpg, jpeg, tiff, tif, bmp, webp, gif
25-11-27.17:23:30.145 [main            ] INFO  DocumentLoaderFactory  - Registered PdfDocumentLoader for extension: pdf
25-11-27.17:23:30.145 [main            ] INFO  DocumentLoaderFactory  - Registered PowerPointDocumentLoader for extensions: pptx, ppt
25-11-27.17:23:30.145 [main            ] INFO  DocumentLoaderFactory  - Registered TextDocumentLoader for extension: txt
25-11-27.17:23:30.145 [main            ] INFO  DocumentLoaderFactory  - Registered WordDocumentLoader for extensions: docx, doc
25-11-27.17:23:30.275 [main            ] ERROR DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
25-11-27.17:23:30.383 [main            ] INFO  IntentRuleService      - 开始刷新意图识别规则...
25-11-27.17:23:30.389 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Starting...
25-11-27.17:23:30.637 [main            ] INFO  HikariPool             - PostgresHikariPool - Added connection org.postgresql.jdbc.PgConnection@1a914a00
25-11-27.17:23:30.638 [main            ] INFO  HikariDataSource       - PostgresHikariPool - Start completed.
25-11-27.17:23:30.654 [main            ] INFO  IntentRuleService      - 意图规则刷新完成，共加载 39 条规则
25-11-27.17:23:30.654 [main            ] INFO  IntentRuleService      - 类型: REGEX, 数量: 3
25-11-27.17:23:30.654 [main            ] INFO  IntentRuleService      - 类型: KEYWORD, 数量: 18
25-11-27.17:23:30.654 [main            ] INFO  IntentRuleService      - 类型: SEMANTIC_EXAMPLE, 数量: 18
25-11-27.17:23:30.655 [main            ] INFO  SemanticIntentDetector - 开始刷新语义路由规则...
25-11-27.17:23:30.658 [main            ] INFO  SemanticIntentDetector - 批量生成 18 个语义路由向量...
25-11-27.17:23:30.658 [main            ] INFO  SpringAIEmbeddingService - 批量生成嵌入向量，文本数量: 18
25-11-27.17:23:30.955 [main            ] INFO  SemanticIntentDetector - 语义路由刷新完成，加载了 6 个路由，共 18 个向量
25-11-27.17:23:30.956 [main            ] INFO  IntentDetectionService - 已注册3个意图检测器: [RuleBasedIntentDetector, SemanticIntentDetector, LlmPlannerIntentDetector]
25-11-27.17:23:30.961 [main            ] INFO  InternalRagService     - InternalRagService 初始化完成，已注册处理器: [BASIC]
25-11-27.17:23:30.961 [main            ] INFO  InMemoryToolRegistry   - 工具注册表初始化完成，已注册工具: [RAG_QUERY]
25-11-27.17:23:30.965 [main            ] INFO  RagOrchestrationService - 已注册1个查询处理器: BASIC
25-11-27.17:23:30.981 [main            ] INFO  RuleBasedQueryRouter   - 已注册1个查询处理器: BASIC
25-11-27.17:23:30.982 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 8
25-11-27.17:23:31.451 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:23:31.664 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 11
25-11-27.17:23:31.819 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:23:31.976 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 9
25-11-27.17:23:32.187 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:23:32.361 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:23:32.523 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:23:32.708 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:23:32.860 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:23:33.031 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:23:33.240 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 21
25-11-27.17:23:33.415 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 23
25-11-27.17:23:33.576 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 22
25-11-27.17:23:33.765 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:23:33.901 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:23:34.041 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:23:34.283 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:23:34.442 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:23:34.649 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:23:34.943 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:23:35.097 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:23:35.332 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:23:35.498 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:23:35.646 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 12
25-11-27.17:23:35.854 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 25
25-11-27.17:23:36.025 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 14
25-11-27.17:23:36.176 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:23:36.381 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 16
25-11-27.17:23:36.519 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:23:36.663 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 17
25-11-27.17:23:36.901 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 13
25-11-27.17:23:37.055 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 15
25-11-27.17:23:37.211 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:23:37.427 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:23:37.559 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:23:37.728 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:23:37.954 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 18
25-11-27.17:23:38.127 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 24
25-11-27.17:23:38.290 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:23:38.477 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:23:38.640 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 19
25-11-27.17:23:38.785 [main            ] INFO  SpringAIEmbeddingService - 生成文本嵌入向量，文本长度: 20
25-11-27.17:23:39.002 [main            ] INFO  SemanticQueryRouter    - 已注册1个查询处理器, 已初始化语义路由模型
25-11-27.17:23:39.047 [main            ] INFO  CacheCleanupService    - 启动时自动清理旧格式缓存（cleanup-on-startup=true）
25-11-27.17:23:39.047 [main            ] INFO  CacheCleanupService    - 开始清理embeddings缓存的旧格式数据...
25-11-27.17:23:39.053 [main            ] INFO  CacheCleanupService    - 未找到需要清理的embeddings缓存键
25-11-27.17:23:39.112 [main            ] INFO  WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
25-11-27.17:23:39.268 [main            ] INFO  PdfParsingTest         - Started PdfParsingTest in 10.123 seconds (process running for 10.553)
25-11-27.17:23:39.269 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配开始
25-11-27.17:23:39.270 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Starting...
25-11-27.17:23:39.348 [main            ] INFO  HikariPool             - MySqlHikariPool - Added connection com.mysql.cj.jdbc.ConnectionImpl@6c80b1d2
25-11-27.17:23:39.348 [main            ] INFO  HikariDataSource       - MySqlHikariPool - Start completed.
25-11-27.17:23:39.355 [main            ] INFO  AiAgentAutoConfiguration - 开始自动装配AI客户端，客户端ID列表: [3001, 3101, 3102, 3103]
25-11-27.17:23:39.355 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:23:39.355 [pool-2-thread-1 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.356 [pool-2-thread-2 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.356 [pool-2-thread-3 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.356 [pool-2-thread-4 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.356 [pool-2-thread-5 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.674 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:23:39.679 [main            ] INFO  RootNode               - Ai 智能体 构建，数据加载节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:23:39.679 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据 clientIdList:[3001, 3101, 3102, 3103]
25-11-27.17:23:39.679 [pool-2-thread-6 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_api) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.679 [pool-2-thread-7 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_model) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.679 [pool-2-thread-8 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_tool_mcp) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.679 [pool-2-thread-9 ] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client_system_prompt) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.679 [pool-2-thread-10] INFO  AiClientLoadDataStrategy - 查询配置数据(ai_client) [3001, 3101, 3102, 3103]
25-11-27.17:23:39.812 [main            ] INFO  AiClientLoadDataStrategy - 加载客户端数据完成
25-11-27.17:23:39.813 [main            ] INFO  AiClientApiNode        - Ai Agent 构建，API配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:23:39.813 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1001
25-11-27.17:23:39.814 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_api_1002
25-11-27.17:23:39.814 [main            ] INFO  AiClientToolMcpNode    - Ai Agent 构建，客户端工具MCP配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:23:40.367 [pool-6-thread-1 ] ERROR McpClientSession       - Error handling notification: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
25-11-27.17:23:40.367 [pool-6-thread-1 ] ERROR Operators              - Operator called default onErrorDropped
reactor.core.Exceptions$ErrorCallbackNotImplemented: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
Caused by: java.lang.IllegalArgumentException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4636)
	at com.fasterxml.jackson.databind.ObjectMapper.convertValue(ObjectMapper.java:4577)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.unmarshalFrom(StdioClientTransport.java:391)
	at io.modelcontextprotocol.client.McpAsyncClient.lambda$asyncLoggingNotificationHandler$37(McpAsyncClient.java:782)
	at io.modelcontextprotocol.spec.McpClientSession.lambda$handleIncomingNotification$6(McpClientSession.java:208)
	at reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:45)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.Mono.subscribeWith(Mono.java:4641)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4403)
	at io.modelcontextprotocol.spec.McpClientSession.handle(McpClientSession.java:152)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onNext(FluxPeekFuseable.java:489)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2571)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.request(FluxPeekFuseable.java:437)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
	at reactor.core.publisher.FluxFlatMap$FlatMapInner.onSubscribe(FluxFlatMap.java:968)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onSubscribe(FluxContextWrite.java:101)
	at reactor.core.publisher.FluxPeekFuseable$PeekFuseableConditionalSubscriber.onSubscribe(FluxPeekFuseable.java:471)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4576)
	at reactor.core.publisher.FluxFlatMap$FlatMapMain.onNext(FluxFlatMap.java:430)
	at reactor.core.publisher.SinkManyUnicast.drainRegular(SinkManyUnicast.java:284)
	at reactor.core.publisher.SinkManyUnicast.drain(SinkManyUnicast.java:365)
	at reactor.core.publisher.SinkManyUnicast.tryEmitNext(SinkManyUnicast.java:239)
	at reactor.core.publisher.SinkManySerialized.tryEmitNext(SinkManySerialized.java:100)
	at io.modelcontextprotocol.client.transport.StdioClientTransport.lambda$startInboundProcessing$6(StdioClientTransport.java:261)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)
	at reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: UNKNOWN; byte offset: #UNKNOWN] (through reference chain: io.modelcontextprotocol.spec.McpSchema$LoggingMessageNotification["data"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1767)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1541)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1446)
	at com.fasterxml.jackson.databind.DeserializationContext.extractScalarFromObject(DeserializationContext.java:958)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:1441)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:48)
	at com.fasterxml.jackson.databind.deser.std.StringDeserializer.deserialize(StringDeserializer.java:11)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:543)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:585)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:447)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1497)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:348)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.ObjectMapper._convert(ObjectMapper.java:4631)
	... 31 common frames omitted
25-11-27.17:23:40.381 [pool-6-thread-1 ] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=desktop-commander, version=0.2.23] and Instructions null
25-11-27.17:23:40.384 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=LoggingCapabilities[], prompts=PromptCapabilities[listChanged=null], resources=ResourceCapabilities[subscribe=null, listChanged=null], tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=desktop-commander, version=0.2.23], instructions=null]
25-11-27.17:23:40.385 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5002
25-11-27.17:23:40.924 [HttpClient-1-Worker-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=AIsearch, version=1.4.1] and Instructions null
25-11-27.17:23:41.094 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=AIsearch, version=1.4.1], instructions=null]
25-11-27.17:23:41.095 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5003
25-11-27.17:23:41.615 [pool-12-thread-1] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], Info: Implementation[name=mcp-server-elasticsearch, version=1.0.0] and Instructions null
25-11-27.17:23:41.615 [main            ] INFO  StdioCreateMcpStrategy - Tool Stdio MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental=null, logging=null, prompts=null, resources=null, tools=ToolCapabilities[listChanged=null]], serverInfo=Implementation[name=mcp-server-elasticsearch, version=1.0.0], instructions=null]
25-11-27.17:23:41.615 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5004
25-11-27.17:23:42.150 [HttpClient-2-Worker-0] INFO  McpAsyncClient         - Server response with Protocol: 2024-11-05, Capabilities: ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], Info: Implementation[name=mcp-server-baidu-maps, version=1.22.0] and Instructions This is a MCP server for Baidu Maps.
25-11-27.17:23:42.294 [main            ] INFO  SseCreateMcpStrategy   - Tool SSE MCP Initialized InitializeResult[protocolVersion=2024-11-05, capabilities=ServerCapabilities[completions=null, experimental={}, logging=null, prompts=PromptCapabilities[listChanged=false], resources=ResourceCapabilities[subscribe=false, listChanged=false], tools=ToolCapabilities[listChanged=false]], serverInfo=Implementation[name=mcp-server-baidu-maps, version=1.22.0], instructions=This is a MCP server for Baidu Maps.]
25-11-27.17:23:42.295 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_tool_mcp_5005
25-11-27.17:23:42.295 [main            ] INFO  AiClientModelNode      - Ai Agent 构建节点，Mode 对话模型{"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:23:42.330 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2001
25-11-27.17:23:42.671 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_model_2002
25-11-27.17:23:42.671 [main            ] INFO  AiClientNode           - Ai Agent 构建，客户端配置节点 {"commandIdList":["3001","3101","3102","3103"],"commandType":"aiClientLoadDataStrategy"}
25-11-27.17:23:42.672 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3001
25-11-27.17:23:42.672 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3101
25-11-27.17:23:42.672 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3102
25-11-27.17:23:42.672 [main            ] INFO  AbstractArmorySupport  - 成功注册Bean: ai_client_3103
25-11-27.17:23:42.672 [main            ] INFO  AiAgentAutoConfiguration - AI Agent 自动装配完成，结果: null
25-11-27.17:23:42.888 [main            ] INFO  HybridDocumentParser   - 开始解析文档，文件: src/test/resources/pdfs/test_pdf_2.pdf, 模式: 自动模式
25-11-27.17:23:42.999 [main            ] INFO  PdfTableDetector       - 表格检测完成: 文件=src/test/resources/pdfs/test_pdf_2.pdf, 页数=2, 检测到表格=true, 表格分数=0.74, 建议=USE_OCR
25-11-27.17:23:42.999 [main            ] INFO  HybridDocumentParser   - 检测到表格（分数: 0.74），使用OCR解析以保留表格结构，文件: src/test/resources/pdfs/test_pdf_2.pdf
25-11-27.17:23:42.999 [main            ] INFO  HybridDocumentParser   - 开始OCR解析，文件: src/test/resources/pdfs/test_pdf_2.pdf
25-11-27.17:23:43.794 [main            ] INFO  PdfRenderService       - PDF渲染完成，成功渲染 2 页
25-11-27.17:23:43.794 [main            ] INFO  HybridDocumentParser   - 开始串行OCR处理，总页数: 2
25-11-27.17:25:00.575 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:25:07.403 [main            ] INFO  DefaultOcrService      - OCR识别成功，使用Provider: 阿里云DashScope (qwen3-vl-plus)
25-11-27.17:25:07.404 [main            ] INFO  HybridDocumentParser   - 串行OCR处理完成，成功: 2/2 页，失败: 0 页
25-11-27.17:25:07.440 [main            ] INFO  HybridDocumentParser   - OCR解析完成: 页数=2, 元素数=30, 表格数=0, 平均置信度=0.9330000000000002, 压缩比=1.0176x, 处理时间=84441ms
25-11-27.17:25:07.463 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown initiated...
25-11-27.17:25:07.464 [SpringApplicationShutdownHook] INFO  HikariDataSource       - MySqlHikariPool - Shutdown completed.
25-11-27.17:25:07.464 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown initiated...
25-11-27.17:25:07.464 [SpringApplicationShutdownHook] INFO  HikariDataSource       - PostgresHikariPool - Shutdown completed.
